template:
  - sensor:
      # Maandelijkse elektriciteitsstatistieken
      - name: "Monthly Electricity Usage"
        unit_of_measurement: "kWh"
        state_class: total
        device_class: energy
        icon: mdi:flash
        state: >
          {% set stats = state_attr('sensor.zonneplan_electricity_consumption_today', 'monthly_stats') %}
          {% if stats %}
            {{ stats[now().month - 1] | float(0) | round(2) }}
          {% else %}
            {{ states('sensor.zonneplan_electricity_consumption_today') | float(0) | round(2) }}
          {% endif %}
          
      - name: "Monthly Solar Production"
        unit_of_measurement: "kWh"
        state_class: total
        device_class: energy
        icon: mdi:solar-power
        state: >
          {% set production = namespace(value=0) %}
          {% set solaredge = states('sensor.solaredge_energieopbrengst_maand') | float(0) %}
          {% set envoy = states('sensor.envoy_122309090641_energy_production_month') | float(0) %}
          {% set growatt = states('sensor.amer_growatt_total_energy_month') | float(0) %}
          {% set production.value = solaredge + envoy + growatt %}
          {{ production.value | round(2) }}
          
      - name: "Monthly Grid Import"
        unit_of_measurement: "kWh"
        state_class: total
        device_class: energy
        icon: mdi:transmission-tower-import
        state: >
          {{ states('sensor.zonneplan_electricity_consumption_month') | float(0) | round(2) }}
          
      # Maandelijkse gasstatistieken
      - name: "Monthly Gas Usage"
        unit_of_measurement: "m³"
        state_class: total
        device_class: gas
        icon: mdi:fire
        state: >
          {{ states('sensor.zonneplan_gas_consumption_month') | float(0) | round(2) }}
          
      - name: "Monthly Degree Days"
        unit_of_measurement: "°C⋅day"
        state_class: measurement
        icon: mdi:thermometer
        state: >
          {% set avg_temp = states('sensor.buiten_temperature') | float(0) %}
          {% set base_temp = 18 %}
          {% set days_in_month = now().day %}
          {% if avg_temp < base_temp %}
            {{ ((base_temp - avg_temp) * days_in_month) | round(1) }}
          {% else %}
            0
          {% endif %}
          
      # Maandelijkse waterstatistieken
      - name: "Monthly Water Usage"
        unit_of_measurement: "m³"
        state_class: total
        device_class: water
        icon: mdi:water
        state: >
          {% set water_usage = states('input_number.water_meter') | float(0) %}
          {{ water_usage | round(2) }}