  - sensor:
      # Energy flow sensoren
      - name: "Zonnestroom Direct Verbruikt Vandaag (dashboard)"
        unit_of_measurement: "kWh"
        state_class: total
        device_class: energy
        state: >
          {% set uit_zon = states('sensor.huisverbruik_van_zon')|float(0) %}
          {% set uren = now().hour + now().minute / 60 %}
          {% if uren > 0 %}
            {{ (uit_zon * uren / 1000)|round(2) }}
          {% else %}
            0
          {% endif %}
        
      - name: "Zonnestroom Naar Batterij Vandaag"
        unit_of_measurement: "kWh"
        state_class: total
        device_class: energy
        state: >
          {{ states('sensor.thuisbatterij_today')|float(0)|round(2) }}
        
      - name: "Teruglevering Vandaag"
        unit_of_measurement: "kWh"
        state_class: total
        device_class: energy
        state: >
          {{ states('sensor.zonneplan_electricity_returned_today')|float(0)|round(2) }}
        
      - name: "Batterij Naar Huis Vandaag"
        unit_of_measurement: "kWh"
        state_class: total
        device_class: energy
        state: >
          {{ states('sensor.thuisbatterij_delivery_today')|float(0)|round(2) }}
        
      - name: "Netstroom Verbruikt Vandaag"
        unit_of_measurement: "kWh"
        state_class: total
        device_class: energy
        state: >
          {{ states('sensor.zonneplan_electricity_consumption_today')|float(0)|round(2) }}
          
      # Zelfvoorziening percentage
      - name: "Percentage Zelfvoorziening Elektriciteit"
        unit_of_measurement: "%"
        state_class: measurement
        icon: mdi:solar-power
        state: >
          {% set totaal_verbruik = states('sensor.zonneplan_electricity_consumption_today')|float(0) + 
                                 states('sensor.dagelijks_zon_verbruik_correct')|float(0) + 
                                 states('sensor.thuisbatterij_delivery_today')|float(0) %}
          {% set zelf_opgewekt = states('sensor.dagelijks_zon_verbruik_correct')|float(0) + 
                               states('sensor.thuisbatterij_delivery_today')|float(0) %}
          {% if totaal_verbruik > 0 %}
            {{ (zelf_opgewekt / totaal_verbruik * 100)|round(1) }}
          {% else %}
            0
          {% endif %}
          
      # Utility sensoren
      - name: "Gas Verbruik Vandaag"
        unit_of_measurement: "m³"
        state_class: total
        device_class: gas
        state: >
          {{ states('sensor.zonneplan_gas_consumption_today')|float(0)|round(2) }}
          
      - name: "Water Verbruik Vandaag"
        unit_of_measurement: "m³"
        state_class: total
        device_class: water
        icon: mdi:water
        state: >
          {% if states('sensor.water_dagelijks') != 'unknown' and states('sensor.water_dagelijks') != 'unavailable' %}
            {{ states('sensor.water_dagelijks')|float(0)|round(2) }}
          {% else %}
            0
          {% endif %}